<script charset="UTF-8" type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
@model Relync.Models.PropertyList

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script type="text/javascript" src="~/Scripts/owl.carousel.js"></script>
<script type="text/javascript">


    function GetMap(){
        // Initialize the map
        map = new Microsoft.Maps.Map(document.getElementById("myMap"),
        { credentials: "ArP9YXvDyZRDN2LPAKH7XtJAK-9bOgPVlu90FXatfLdRaH9246hGOQWnnH3qbF4m", showScalebar: false,enableSearchLogo:false,showMapTypeSelector:false,showDashboard:false,disablePanning: true });
        // Define the pushpin location
        var loc = new Microsoft.Maps.Location(@Model.lat, @Model.lon);

        // Add a pin to the map
        var pin = new Microsoft.Maps.Pushpin(loc);
        map.entities.push(pin);
        // Center the map on the location
        map.setView({ center: loc, zoom: 16 });
    }
    $().ready(function () {
        $("form[action$='AddComment']").on("submit", function () {
            $.post(
               $(this).attr("action"),
               $(this).serialize(),
               function (response) {
                   if (response.Result == "ok") {
                       $(response.CommentHtml).hide().prependTo("#comment-list").fadeIn(1000);
                       $("#add-comment").html(response.FormHtml);
                       $("#Details").val("");
                   }
                   else {
                       $("#add-comment").html(response.FormHtml);
                   }
               });
            return false;
        });

        $("#load-more").on('click', function() {
            $.post(
                '@Url.Action("CommentList")',
                { postId: '@Model.Id', skip : $(this).data("LoadedComments"), limit : 5, totalComments: @ViewBag.TotalComments },
                function (response) {
                    $("#comment-list").find("#load-more").parent().replaceWith($(response).fadeIn(1000));
                });
        });

        $(".remove-comment").on('click', function() {
            var commnt=$(this).parent();
            $.post(
            '@Url.Action("RemoveComment")',
            {
                Id:'@Model.Id', commentID: $(this).data("commentID")},
                function(){
                    commnt.fadeOut(1000,function(){$(this).remove();});
                });

        });

    });
</script>
<body onfocus="GetMap();">
    <h4 class="col-lg-offset-1">@Html.DisplayFor(model => model.pptyType) - @Html.DisplayFor(model => model.District) - @Html.DisplayFor(model => model.Suburb) - @Html.DisplayFor(model => model.Contact)</h4>



    <div class="col-lg-12 owl-carousel owl-theme">
        @foreach (var items in Model.ImageList)
        {
            <div class="item">
                <img src="@items.ImagePath" alt="@items.Name" class="img-rounded" />
            </div>
        }
        <div class="item active" >
           
        </div>
        <div class="item">
            <img src="@Model.planLink" class="img-rounded"/>
        </div>
    </div>
    <div id='myMap' style="position:relative; height:400px; width:500px"></div>   
  
    <div class="row" data-spy="affix" style="background-color:#D2D0C8; z-index:15; width:100%;" data-offset-top="600">
        <div class="col-lg-8">
            <div class="col-lg-offset-2 left" >
                <dl>
                    <dt>
                        @Html.DisplayFor(model => model.Suburb)
                    </dt>
                    <dd>
                       
                        <b>@Html.DisplayFor(model => model.Place)</b>
                        <br>@Html.DisplayFor(model => model.Bedrooms)&nbsp;Bedrooms&nbsp;|&nbsp;
                        <span></span>@Html.DisplayFor(model => model.Baths)&nbsp;Baths
                    </dd>
                        </dl>
             
            </div>
            <div class="col-lg-2 text-right right" style="border-left: solid #F1C40F 1px;";>
                <dl>
                    <br />
                    <dt> @Html.DisplayFor(model => model.Price)</dt>
                    <dd>
                        <small>per month</small>
                    </dd>
                </dl>
            </div>
            
        </div>
        </div>
    <div class="row" style="background-color:#fff">
       
            <dl class="dl-horizontal col-lg-8">
                <dd>
                    <b> @Html.DisplayName("General Description")</b>

                </dd>
                <dd>
                    @Html.DisplayFor(model => model.GDescription)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.Price)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Price)
                </dd>



                <dt>
                    @Html.DisplayNameFor(model => model.Facts)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Facts)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.Rooms)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Rooms)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.Construction)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Construction)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.Other)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Other)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.Nearby)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Nearby)
                </dd>



                <dt>
                    @Html.DisplayNameFor(model => model.Date)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Date)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.ContactName)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.ContactName)
                </dd>



               
                <dt>
                    @Html.DisplayNameFor(model => model.Email)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Email)
                </dd>
                <dt>
                    @Html.DisplayName("Video Tour")
                </dt>
                <dd class="embed-responsive embed-responsive-16by9">
                    <iframe class="embed-responsive-item" src="http://www.youtube.com/embed/@Html.DisplayFor(mode => mode.vidLink)?rel=0" frameborder="0" allowfullscreen></iframe>
                </dd>


            </dl>
            <div class="col-lg-4 right" data-spy="affix" data-offset-top="1000">

            <dl>
                <dt class="text-center ">
                    @Html.DisplayName("Please Call")&nbsp;@Html.DisplayFor(model => model.ListedBy)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Phone)
                </dd>

            </dl>
        </div>
            <div>

            </div>

        </div>
    <h3>Comments</h3>
  
    <div id="add-comment">
        @Html.Partial("AddComment", new Relync.Models.Comment())
    </div>
    <div id="comment-list">
        @if (Model.Commnt != null)
        {
            Html.RenderPartial("CommentList", Model.Commnt);
        }
    </div>
    <p>
      <!--  @Html.ActionLink("Edit", "Edit", new { id = Model.Id }) |-->
        @Html.ActionLink("Back to List", "Map")
    </p>
</body>
@Scripts.Render("~/bundles/jquery")